<section class="">
  <div class="p-4 sm:ml-64">
    <div class="md:flex md:justify-center">
      <form class="md:w-2/3" [formGroup]="addBranchForm">
        <div class="rounded-lg p-4 md:px-10 md:pb-2 md:pt-6">
          <div class="mb-6 flex justify-between">
            <h1 class="text-xl font-semibold">Add Branch</h1>
            <button routerLink="/home/branchList">
              <svg
                class="h-8 w-8 rounded-lg bg-gray-100 p-1 text-gray-600 transition-all duration-500 hover:bg-red-600 hover:text-white dark:text-white"
                aria-hidden="true"
                xmlns="http://www.w3.org/2000/svg"
                width="24"
                height="24"
                fill="none"
                viewBox="0 0 24 24"
              >
                <path
                  class=""
                  stroke="currentColor"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M6 18 17.94 6M18 18 6.06 6"
                />
              </svg>
            </button>
          </div>
          <div class="mb-6 grid gap-6 md:grid-cols-2">
            <div>
              <label
                for="first_name"
                class="mb-2 block text-sm font-medium text-gray-900 dark:text-white"
                >Branch Name</label
              >
              <input
                type="text"
                formControlName="branchName"
                class="input-form"
                placeholder="Branch Name"
                [ngClass]="{
                  error:
                    addBranchForm.get('branchName')?.invalid &&
                    addBranchForm.get('branchName')?.touched
                }"
                required
              />
              <div
                *ngIf="
                  (addBranchForm.controls['branchName'].invalid &&
                    addBranchForm.controls['branchName'].touched) ||
                  addBranchForm.controls['branchName'].dirty
                "
              >
                <small
                  class="text-danger ml-2 text-red-600"
                  *ngIf="
                    addBranchForm.controls['branchName'].errors?.['required']
                  "
                  >Branch Name is Required !
                </small>
                <small
                  class="text-danger ml-2 text-red-600"
                  *ngIf="
                    addBranchForm.controls['branchName'].errors?.['minlength']
                  "
                  >Branch Name is min length required !
                </small>
              </div>
            </div>
            <div>
              <label
                for="Manager"
                class="mb-2 block text-sm font-medium text-gray-900 dark:text-white"
                >Branch Manager</label
              >
              <input
                type="text"
                formControlName="manager"
                class="input-form"
                [ngClass]="{
                  error:
                    addBranchForm.get('manager')?.invalid &&
                    addBranchForm.get('manager')?.touched
                }"
                placeholder="Manager Name"
                required
              />
              <div
                *ngIf="
                  (addBranchForm.controls['manager'].invalid &&
                    addBranchForm.controls['manager'].touched) ||
                  addBranchForm.controls['manager'].dirty
                "
              >
                <small
                  class="text-danger ml-2 text-red-600"
                  *ngIf="addBranchForm.controls['manager'].errors?.['required']"
                  >Branch Manager is Required !
                </small>
                <small
                  class="text-danger ml-2 text-red-600"
                  *ngIf="
                    addBranchForm.controls['manager'].errors?.['minlength']
                  "
                  >Branch Manager is min length required !
                </small>
              </div>
            </div>
            <div>
              <label
                class="mb-2 block text-sm font-medium text-gray-900 dark:text-white"
                >Phone</label
              >
              <div class="relative">
                <div
                  class="pointer-events-none absolute inset-y-0 start-0 flex items-center ps-3.5"
                  >
                  <svg
                    class="h-5 w-5 text-gray-500 dark:text-gray-400"
                    aria-hidden="true"
                    xmlns="http://www.w3.org/2000/svg"
                    width="24"
                    height="24"
                    fill="currentColor"
                    viewBox="0 0 24 24"
                  >
                    <path
                      d="M7.978 4a2.553 2.553 0 0 0-1.926.877C4.233 6.7 3.699 8.751 4.153 10.814c.44 1.995 1.778 3.893 3.456 5.572 1.68 1.679 3.577 3.018 5.57 3.459 2.062.456 4.115-.073 5.94-1.885a2.556 2.556 0 0 0 .001-3.861l-1.21-1.21a2.689 2.689 0 0 0-3.802 0l-.617.618a.806.806 0 0 1-1.14 0l-1.854-1.855a.807.807 0 0 1 0-1.14l.618-.62a2.692 2.692 0 0 0 0-3.803l-1.21-1.211A2.555 2.555 0 0 0 7.978 4Z"
                    />
                  </svg>
                </div>
                <input
                  type="text"
                  #phone
                  class="icon-input"
                  formControlName="branchMobilenumber"
                  placeholder="123-456-970"
                  required
                  [ngClass]="{
                    error:
                      addBranchForm.get('branchMobilenumber')?.invalid &&
                      addBranchForm.get('branchMobilenumber')?.touched
                  }"
                />
              </div>
                <div
                  *ngIf="
                    (addBranchForm.controls['branchMobilenumber'].invalid &&
                      addBranchForm.controls['branchMobilenumber'].touched) ||
                    addBranchForm.controls['branchMobilenumber'].dirty
                  "
                >
                  <small
                    class="text-danger ml-2 text-red-600"
                    *ngIf="
                      addBranchForm.controls['branchMobilenumber'].errors?.[
                        'required'
                      ]
                    "
                    >Branch Mobile Number is Required !
                  </small>
                  <small
                    class="text-danger ml-2 text-red-600"
                    *ngIf="
                      addBranchForm.controls['branchMobilenumber'].errors?.[
                        'minlength'
                      ]
                    "
                    >Mobile Number is Not Valid !
                  </small>
                </div>
              
            </div>

            <div>
              <label
                class="mb-2 block text-sm font-medium text-gray-900 dark:text-white"
                >Gst Number</label
              >
              <input
                type="text"
                formControlName="gstNumber"
                class="input-form"
                placeholder="Gst"
                [ngClass]="{
                  error:
                    addBranchForm.get('gstNumber')?.invalid &&
                    addBranchForm.get('gstNumber')?.touched
                }"
                required
              />
              <div
                *ngIf="
                  (addBranchForm.controls['gstNumber'].invalid &&
                    addBranchForm.controls['gstNumber'].touched) ||
                  addBranchForm.controls['gstNumber'].dirty
                "
              >
                <small
                  class="text-danger ml-2 text-red-600"
                  *ngIf="
                    addBranchForm.controls['gstNumber'].errors?.['required']
                  "
                  >Branch gstNumber is Required !
                </small>
                <small
                  class="text-danger ml-2 text-red-600"
                  *ngIf="
                    addBranchForm.controls['gstNumber'].errors?.['pattern']
                  "
                  >GST Pattern is invalid !
                </small>
              </div>
            </div>
          </div>
          <div class="mb-2">
            <label
              for="Address"
              class="mb-2 block text-sm font-medium text-gray-900 dark:text-white"
              >Address</label
            >
            <input
              type="text"
              class="input-form"
              formControlName="add1"
              placeholder="Flat, House no., Building, Company, Apartment"
              minlength="20"
              maxlength="150"
              required
            />
            <div
              *ngIf="
                (addBranchForm.controls['add1'].invalid &&
                  addBranchForm.controls['add1'].touched) ||
                addBranchForm.controls['add1'].dirty
              "
            >
              <small
                class="text-danger ml-2 text-red-600"
                *ngIf="addBranchForm.controls['add1'].errors?.['required']"
                >Address-1 is Required !
              </small>
              <small
                class="text-danger ml-2 text-red-600"
                *ngIf="addBranchForm.controls['add1'].errors?.['minlength']"
                >Address-1 min length required !
              </small>
              <small
                class="text-danger ml-2 text-red-600"
                *ngIf="addBranchForm.controls['add1'].errors?.['maxlength']"
                >Address-1 length out of bound !  
              </small>
            </div>
          </div>
          <div class="mb-6">
            <input
              type="text"
              formControlName="add2"
              class="input-form"
              placeholder="Area, Street, Sector, Village"
              minlength="20"
              maxlength="100"
              required
            />
            <div
              *ngIf="
                (addBranchForm.controls['add2'].invalid &&
                  addBranchForm.controls['add2'].touched) ||
                addBranchForm.controls['add2'].dirty
              "
            >
              <small
                class="text-danger ml-2 text-red-600"
                *ngIf="addBranchForm.controls['add2'].errors?.['required']"
                >Address-2 is Required !
              </small>
              <small
                class="text-danger ml-2 text-red-600"
                *ngIf="addBranchForm.controls['add2'].errors?.['minlength']"
                >Address-2 min length required !
              </small>
              <small
                class="text-danger ml-2 text-red-600"
                *ngIf="addBranchForm.controls['add2'].errors?.['maxlength']"
                >Address-2 length out of bound !
              </small>
            </div>
          </div>
          <div class="mb-6 grid gap-6 md:grid-cols-2">
            <div>
              <label
                for="pinCode"
                class="mb-2 block text-sm font-medium text-gray-900 dark:text-white"
                >Pincode</label
              >
              <input
                type="text"
                formControlName="pinCode"
                class="input-form"
                placeholder="000 000"
                required
              />
              <div
                *ngIf="
                  (addBranchForm.controls['pinCode'].invalid &&
                    addBranchForm.controls['pinCode'].touched)              
                "
                >
                <small
                  class="text-danger ml-2 text-red-600"
                  *ngIf="
                    addBranchForm.controls['pinCode'].errors?.['required']
                  "
                  >Pincode is Required !
                </small>
                <small
                  class="text-danger ml-2 text-red-600"
                  *ngIf="
                    addBranchForm.controls['pinCode'].errors?.['minlength']
                  "
                  >Pincode is min length required !
                </small>
              </div>
            </div>
            <div>
              <label
                for="city"
                class="mb-2 block text-sm font-medium text-gray-900 dark:text-white"
                >Town/City</label
              >
              <select class="input-form" formControlName="city" 
                [ngClass]="{
                  error:
                    addBranchForm.get('city')?.invalid &&
                    addBranchForm.get('city')?.touched
                }"
                required>
                <!-- <option null selected disabled>Choose Town/City</option> -->
                <option *ngFor="let option of cityDropDownOptions" value="{{ option.value }}">
                  {{ option.label }}
                </option>
              </select>
              <small
                *ngIf="
                    addBranchForm.controls['city'].invalid &&
                    addBranchForm.controls['city'].touched
                    "
                  class="text-danger ml-2 text-red-600"
                >
                City is required!
              </small>
            </div>

            <div>
              <label
                for="State"
                class="mb-2 block text-sm font-medium text-gray-900 dark:text-white"
                >State</label
              >
              <input
                class="input-form"
                #statevalue
                formControlName="state"
                [ngClass]="{
                  error:
                    addBranchForm.get('state')?.invalid &&
                    addBranchForm.get('state')?.touched
                }"
                (change)="fetchCity(statevalue.value)"
                readonly
              />
                <!-- <option null selected disabled>Choose State</option>
                <option *ngFor="let state of _state" value="{{ state.sname }}">
                  {{ state.sname }}
                </option> -->
              <!-- </select> -->
              <small
                *ngIf="
                  addBranchForm.controls['state'].invalid &&
                  addBranchForm.controls['state'].touched
                  "
                class="text-danger ml-2 text-red-600"
              >
                State is required!
              </small>
            </div>

            <div>
              <label
                for="country"
                class="mb-2 block text-sm font-medium text-gray-900 dark:text-white"
                >Country/Region</label
              >
              <input
                class="input-form"
                #countryvalue
                formControlName="country"
                [ngClass]="{
                  error:
                    addBranchForm.get('country')?.invalid &&
                    addBranchForm.get('country')?.touched
                }"
                required
                (change)="fetchState(countryvalue.value)"
                readonly
              />
                <!-- <option null selected disabled>Choose Country</option>
                <option value="India">India</option> -->
              <!-- </select> -->
              <small
                *ngIf="
                  addBranchForm.controls['country'].invalid &&
                  addBranchForm.controls['country'].touched
                  "
                class="text-danger ml-2 text-red-600"
                >
                Country is required!
              </small>
            </div>
            
            
            
          </div>
          <label
            for="Pincode"
            class="mb-2 block text-sm font-medium text-gray-900 dark:text-white"
            >Department</label
          >
          <div class="mb-4 grid grid-cols-2 items-center gap-6">
            <div>
              <select class="input-form" type="text" #department required>
                <option value="">Choose department</option>
                <option
                  *ngFor="let department of _department; let i = index"
                  value="{{ department.departId }}"
                >
                  {{ department.deptName }}
                </option>
              </select>
            </div>
            <div>
              <button
                type="button"
                (click)="addDepartList(department.value)"
                class="mb-2 mt-2 w-full rounded-lg bg-blue-700 px-5 py-2.5 text-center text-sm font-medium text-white transition-all duration-300 hover:bg-blue-800 focus:outline-none focus:ring-4 focus:ring-blue-300 active:translate-y-2 dark:bg-blue-600 dark:hover:bg-blue-700 dark:focus:ring-blue-800 sm:w-auto"
              >
                Add Department
              </button>
            </div>
          </div>
          <div>
            <h1 class="mb-4 text-sm font-medium text-gray-500">
              Department List Added
            </h1>
            <ul>
              <li
                *ngFor="let department of selectedDepartments; let i = index"
                class="mb-1 rounded-lg border bg-gray-100 p-2.5 transition-all duration-500 hover:border-gray-300 hover:bg-gray-200"
              >
                <div class="flex items-center justify-between">
                  <div>{{ department.deptName }}</div>

                  <button (click)="removeDepartmentList(i)">
                    <svg
                      class="w-6 text-red-600 dark:text-white"
                      aria-hidden="true"
                      xmlns="http://www.w3.org/2000/svg"
                      width="24"
                      height="24"
                      fill="none"
                      viewBox="0 0 24 24"
                    >
                      <path
                        stroke="currentColor"
                        stroke-linecap="round"
                        stroke-linejoin="round"
                        stroke-width="2"
                        d="M5 7h14m-9 3v8m4-8v8M10 3h4a1 1 0 0 1 1 1v3H9V4a1 1 0 0 1 1-1ZM6 7h12v13a1 1 0 0 1-1 1H7a1 1 0 0 1-1-1V7Z"
                      />
                    </svg>
                  </button>
                </div>
              </li>
            </ul>
          </div>

          <button
            [disabled]="addBranchForm.invalid"
            (click)="submitBranchForm(addBranchForm.value)"
            type="button"
            [ngClass]="{
              'bg-gray-400':
                addBranchForm.invalid,
              'hover:bg-gray-400':
                addBranchForm.invalid
            }"
            class="mb-2 mt-2 w-full rounded-lg bg-blue-700 px-5 py-2.5 text-center text-sm font-medium text-white transition-all duration-300 hover:bg-blue-800 focus:outline-none focus:ring-4 focus:ring-blue-300 active:translate-y-2 dark:bg-blue-600 dark:hover:bg-blue-700 dark:focus:ring-blue-800 sm:w-auto"
          >
            Submit
          </button>
        </div>
      </form>
    </div>
  </div>
</section>
